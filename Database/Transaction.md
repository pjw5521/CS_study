## Transaction (트랜잭션)

#### 작성자 : [박지원](@pjw5521)

</br>

### 1. **트랜잭션(Transaction)** 이란 ?
- 데이터베이스의 상태를 변화시키기 위해 수행하는 작업의 단위 
- 작업의 완전성을 보장 
- 사람이 정하는 기준에 따라 정하는 것 
**사용 이유**
- 데이터의 일관성을 유지하면서 안정적으로 데이터를 복구하기 위함 

</br>

### 2. 트랜잭션의 특징  
**원자성(Atomicity)**
- 트랜잭션이 데이터베이스에 모두 반영되거나, 모두 반영되지 않아야 함.
- 트랜잭션 중간에 어떠한 문제가 발생한다면 트랜잭션에 속한 어떠한 작업도 수행되어서는 안되며, 문제가 발생하지 않았다면 모든 작업이 수행되어야 함.

**일관성(Consistency)**
- 트랜잭션이 완료된 다음의 상태에서도 트랜잭션이 일어나기 전의 상황과 동일하게 항상 일관성 있어야 함.
- 트랜잭션이 진행되는 동안 데이터베이스가 변경되더라도 업데이트된 데이터베이스로 작업이 진행되는 것이 아니라, 처음에 참조한 데이터베이스로 진행

**고립성(Isolation)**
- 각 트랜잭션은 서로 간섭없이 독립적으로 수행되어야 함.

**지속성(Durability)**
- 트랜잭션이 정상적으로 종료된 다음 영구적으로 데이터베이스에 결과가 저장되어야 함.

</br>

### 3. 트랜잭션의 연산 
**Commit**
- 하나의 트랜잭션이 성공적으로 끝나서 데이터베이스가 일관성 있는 상태에 있음을 의미

**Rollback**
- 하나의 트랜잭션 처리가 비정상적으로 죵료되었음을 의미
- 트랜잭션을 다시 실행하거나, 부분적으로 변경된 결과 취소 가능 

</br>

### 4. 트랜잭션의 상태 
![transaction-status](https://user-images.githubusercontent.com/43839859/164625817-53373c24-5383-4d18-ab00-f0a3345e742a.png)

**Active**
- 트랜잭션이 현재 실행 중인 상태

**Failed**
- 트랜잭션이 실행되다가 문제가 발생되어 중단된 상태

**Aborted**
- 트랜잭션이 비정상 종료되어 Rollback이 수행된 상태

**Partially Committed**
- 트랜잭션의 연산이 마지막까지 실행되고 Commit 되기 직전 상태 

**Committed**
- 트랜잭션이 성공적으로 종료되어 Commit 연산을 실행한 후의 상태 

</br>

### 4. 트랜잭션의 문제점
**동시성 처리 이슈**
1. dirty read 
- 다른 트랜잭션에 의해 수정됐지만, 아직 commit 되지 않은 데이터를 읽는 문제 

2. non-repeatable read 
- 한 트랜잭션에서 같은 데이터를 두 번 읽었는데, 그 사이에 데이터가 변경되거나 삭제되어 결과가 다르게 나타나는 문제

3. Phantom read 
- 한 트랜잭션 내에서 같은 쿼리를 두 번 수행했는데, 첫 번째 쿼리에서 없던 유령 레코드가 두 번째 쿼리에서 나타나는 현상 
- Insert 작업에 의해 발생하는 read 현상 

</br>

### 5. 트랜잭션의 격리 수준 
- 병렬 트랜잭션에서 특정 트랜잭션이 다른 트랜잭션에서 변경하는 데이터를 언제 볼 수 있는지 허용하는 수준
- 수준이 높아질수록 동시성이 저하 

**Read Uncommitted**
- commit 여부와 상관없이 변경되는 데이터 확인 가능 
- Dirty read, Non-Repeatable Read, Phantom Read 발생 가능 

**Read Uncommitted**
- 다른 트랜잭션의 commit이 완료된 데이터만 확인 가능 
- Non-Repeatable Read, Phantom Read 발생 가능 

**Repeatable Read**
- 한 트랜잭션이 시작되면 다른 트랜잭션에서 commit된 데이터가 있더라도 확인되지 않음
- Phantom Read 발생 가능 

**Serializable**
- 가장 높은 수준의 격리 수준 
- 한 트랜잭션에서 사용하는 데이터는 다른 트랜잭션에서 사용 불가능 
