# TDD

## TDD란?

- Test Driven Development의 약자로 ‘테스트 주도 개발'이라고 한다.
- 매우 짧은 개발 사이클의 반복에 의존하는 소프트웨어 개발 프로세스
- 작은 단위의 테스트 케이스를 작성하고 이를 통과하는 코드를 추가하는 단계를 반복하여 구현한다.
- 짧은 개발 주기의 반복에 의존하는 개발 프로세스. 애자일 방법론 중 하나인 XP의 ‘Test-First’ 개념에 기반을 둔 단순한 설계를 중요시한다.
- 이 기법을 개발했거나 ‘재발견'한 것으로 인정되는 Kent Beck은 2003년 TDD가 단순한 설계를 장려하고 자신감을 불어넣어준다고 말하였다.
<br/>

> **eXtreme Programming(XP)란?**
> 

미래에 대한 예측을 최대한 하지 않고 지속적으로 프로토타입을 완성하는 애자일 방법론 중 하나. 이 방법론은 추가 요구사항이 생기더라도 실시간으로 반영할 수 있다.
<br/><br/>

## TDD 개발주기


![tdd개발주기](https://user-images.githubusercontent.com/67946662/163696559-e4d7d2ef-3da2-46b1-b2fd-758565c3c76b.png)


** <Red> 단계** : 실패하는 테스트 코드를 먼저 작성

** <Green> 단계** : 테스트 코드를 성공시키기 위한 실제 코드를 작성

** <Yellow> 단계** : 중복 코드 제거, 일반화 등 리팩토링 수행

⇒ 중요한 것은 실패하는 테스트 코드를 작성할 때까지 실제 코드를 작성하지 않는 것과, 실패하는 테스트를 통과할 정도의 최소 실제 코드를 작성해야 하는 것이다. 이를 통해, 실제 코드에 대해 기대되는 바를 보다 명확하게 정의함으로써 불필요한 설계를 피할 수 있고, 정확한 요구 사항에 집중할 수 있다.

⇒ 테스트를 작성하기 위해서, 개발자는 해당 기능의 요구사항과 명세를 분명히 이해하고 있어야 한다. 이는 사용자 케이스와 사용자 스토리 등으로 이해할 수 있으며, 이는 개발자가 코드를 작성하기 전에 보다 요구사항에 집중할 수 있도록 도와준다. 이는 정말 중요한 부분이자 테스트 주도 개발이 주는 이점이라고 볼 수 있다.

<br/><br/>
  
## 일반 개발 방식과 TDD 개발 방식의 비교

### 1) 일반 개발 방식

![일반개발방식](https://user-images.githubusercontent.com/67946662/163696565-d736ed78-3d2d-4f4b-99fe-dc8fb526197d.png)


- 개발 주기 : 요구사항 분석 → 설계 → 개발 → 테스트 → 배포
- 소프트웨어 개발을 느리게 하는 잠재적 위험 존재
    - 소비자의 요구사항이 처음부터 명확하지 않을 수 있음 ⇒ 처음부터 완벽한 설계 어려움
    - 자체 버그 검출 능력 저하 또는 소스코드 품질 저하 가능
    - 자체 테스트 비용 증가 (작은 부분의 기능 수정에도 모든 부분의 테스트 필요)
    
    ⇒ 코드의 재사용이 어렵고 관리가 어려워져 유지보수를 어렵게 함
    
<br/>

### 2) TDD 개발 방식
  
![TDD개발방식](https://user-images.githubusercontent.com/67946662/163696569-68774df5-be67-4347-b9a4-525eadbdc072.png)

  
- 테스트 코드를 작성한 뒤 실제 코드 작성
- 디자인(설계) 단계에서 프로그래밍 목적 정의와 테스트 케이스 작성 필요
- 테스트 코드를 작성하는 도중에 발생하는 예외 사항(버그, 수정사항)들은 테스트케이스에 추가하고 설계 개선
- 이후 테스트가 통과된 코드만을 코드 개발 단계에서 실제 코드로 작성

⇒ 이 과정의 반복으로 자연스럽게 코드의 버그가 줄어들고 소스코드가 간결해진다.

⇒ 테스트 케이스 작성으로 인해 자연스럽게 설계가 개선되어 재설계 시간이 절감된다.

<br/><br/>

## TDD 개발 방식의 장점

- 보다 튼튼한 객체 지향적 코드 생산
    - TDD는 코드의 재사용 보장을 명시하므로 TDD를 통한 소프트웨어 개발 시 기능 별 철저한 모듈화가 이뤄진다. 이는 종속성과 의존성이 낮은 모듈로 조합된 소프트웨어 개발을 가능하게 하며 필요에 따라 모듈을 추가하거나 제거해도 소프트웨어 전체 구조에 영향을 미치지 않게 된다.
- 재설계 시간의 단축
    - 테스트 코드를 먼저 작성하기 때문에 개발자가 지금 무엇을 해야하는지 분명히 정의하고 개발을 시작하게 된다. 또한 테스트 시나리오를 작성하면서 다양한 예외사항에 대해 생각해볼 수 있다. 이는 개발 진행 중 소프트웨어의 전반적인 설계가 변경되는 일을 방지할 수 있다.
- 디버깅 시간의 단축
    - 이는 유닛 테스팅을 하는 이점이기도 하다. 예를 들면 사용자의 데이터가 잘못 나온다면 DB의 문제인지, 비즈니스 레이어의 문제인지 UI의 문제인지 실제 모든 레이러들을 전부 디버깅 해야하지만, TDD의 경우 자동화 된 유닛테스팅을 전재하므로 특정 버그를 손 쉽게 찾아낼 수 있다.
- 테스트 문서의 대체 가능
    - 주로 SI 프로젝트 진행 과정에서 어떤 요소들이 테스트 되었는지 테스트 정의서를 만든다. 이것은 단순 통합 테스트 문서에 지나지 않는다. 하지만 TDD를 하게 될 경우 테스팅을 자동화 시킴과 동시에 보다 정확한 테스트 근거를 산출할 수 있다.
- 추가 구현의 용이함
    - 개발이 완료된 소프트웨어에 어떤 기능을 추가할 때 가장 우려되는 점은 해당 기능이 기존 코드에 어떤 영향을 미칠지 알지 못한다는 것이다. 하지만 TDD의 경우 자동화된 유닛 테스팅을 전제하므로 테스트 기간을 획기적으로 단축시킬 수 있다.
    
<br/><br/>

## TDD 개발 방식의 단점

- 생산성의 저하
    - 처음부터 2개의 코드를 짜야하고, 중간중간 테스트를 통해 고쳐나가야 한다. TDD 방식의 개발 시간은 일반적 개발 방식에 비해 대략 10~30% 정도 늘어난다.
    - SI 프로젝트에서는 소프트웨어 품질보다 납기일 준수가 훨씬 중요하여 TDD 방식을 잘 사용하지 않는다.
    
<br/><br/>

## **의문점들**

### **Q. 코드 생산성에 문제가 있지는 않나?**

두 배는 아니더라도 분명 코드량이 늘어난다. 비즈니스 로직, 각종 코드 디자인에도 시간이 많이 소요되는데, 거기에다가 테스트 코드까지 작성하기란 여간 벅찬 일이 아닐 것이다. 코드 퀄리티보다는 빠른 생산성이 요구되는 시점에서 TDD 는 큰 걸림돌이 될 수 있다.

### **Q. 테스트 코드를 작성하기가 쉬운가?**

이 또한 TDD라는 개발 방식을 적용하기에 큰 걸림돌이 된다. 진입 장벽이 존재한다는 것이다. 어떠한 부분을 테스트해야할 지, 어떻게 테스트해야할 지, 여러 테스트 프레임워크 중 어떤 것이 우리의 서비스와 맞는지 등 여러 부분들에 대한 학습이 필요하고 익숙해지는데에도 시간이 걸린다. 팀에서 한 명만 익숙해진다고 해결될 일이 아니다. 개발은 팀 단위로 수행되기 때문에 팀원 전체의 동의가 필요하고 팀원 전체가 익숙해져야 비로소 테스트 코드가 빛을 발하게 되는 것이다.

### **Q. 모든 상황에 대해서 테스트 코드를 작성할 수 있는가? 작성해야 하는가?**

세상에는 다양한 사용자가 존재하며, 생각지도 못한 예외 케이스가 존재할 수 있다. 만약 테스트를 반드시 해봐야 하는 부분에 있어서 테스트 코드를 작성하는데 어려움이 발생한다면? 이러한 상황에서 주객이 전도하는 상황이 발생할 수 있다. 분명 실제 코드가 더 중심이 되어야 하는데 테스트를 위해서 코드의 구조를 바꿔야 하나하는 고민이 생긴다. 또한 발생할 수 있는 상황에 대한 테스트 코드를 작성하기 위해 배보다 배꼽이 더 커지는 경우가 허다하다. 실제 구현 코드보다 방대해진 코드를 관리하는 것도 쉽지만은 않은 일이 된 것이다.

모든 코드에 대해서 테스트 코드를 작성할 수 없으며 작성할 필요도 없다. 또한 테스트 코드를 작성한다고 해서 버그가 발생하지 않는 것도 아니다. 애초에 TDD 는 100% coverage 와 100% 무결성을 주장하지 않았다.
