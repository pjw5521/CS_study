## 웹 통신의 큰 흐름 

#### 작성자 : [박지원](@pjw5521)

</br>

### 면접 질문 예시 
- OSI 7 계층에 대한 설명 (IP, MAC, 패킷 등 포함)
- 페이지가 렌더링 되는 과정 설명 

### 1. 네트워크와 노드 ?
- 네트워크 : 물리적 전송 매체를 사용하여 서로 연결된 장치 집합 
- 노드 : 전자 정보 전송, 수신하는데 사용되는 네트워크 구성 요소 
- 분류 by 범위 
    + LAN(Local Area Network)
    + MAN(Metropolitan Area Network)
    + WAN(Wide Area Network)
    
### 2. OSI 7 계층 
- ISO(국제표준화기구)에서 네트워크 통신 과정을 7단계로 정의한 국제통신표준규약
- 응용, 표현, 세션, 전송, 네트워크, 데이터링크, 물리계층으로 나뉜다.
- 전송 시 7계층에서 1계층으로 각 층마다 인식할 수 있는 헤더를 붙인다.(캡슐화)
- 수신 시 1계층에서 7계층으로 헤더를 제거한다. (디캡슐화)

**물리 계층(Physical Layer)**
- 최하위 계층
- 주로 전기적, 기계적, 기능적인 특성을 이용해 데이터를 전송 
- 데이터는 0과 1의 비트별, 즉 On, Off의 전기적 신호 상태로 이루어져 해당 계층은 데이터를 전달
- 데이터 전달의 역할을 할 뿐이라 알고리즘, 오류 제어 기능 없음
- 장비 : 케이블, 리피터, 허브 등 
- 허브와 리피터의 차이 
    + 공통점 :  
    물리 계층에서 전기적인 신호를 증폭시켜 전송 거리 연장 </br>네트워크 신호가 연결된 모든 PC에 전달되기 때문에 연결된 장치가 많을수록 부하 심해진다.
    + 차이점 : </br>
    허브는 패킷 모니터링과 멀티 포트를 지원하여 문제가 생긴 곳을 고립시킬 수 있다.

**데이터링크 계층(Data-Link Layer)**
- 물리적인 연결을 통하여 인접한 두 장치 간의 신뢰성 있는 정보 전송을 담당 (Point-To-Point 전송)
- 안전한 정보 전달을 위해 오류나 재전송 기능 존재
- MAC 주소를 통해 통신
- MAC 주소 
    + 하드웨어 자체에 부여된 고유한 물리적인 주소 
- 데이터 단위 : 프레임(Frame)
- 장비 : 브리지, 스위치 등
- **ARP/ RARP 프로토콜**
    + 네트워크 계층에서 사용되는 주소 결정 프로토콜 
    + ARP : IP 주소에서 MAC 주소 알아냄 
    + RARP : MAC 주소에서 IP 주소 알아냄 

**네트워크 계층(Network Layer)**
- 중계 노드를 통하여 전송하는 경우 어떻게 중계할 것인가 규정 
- 라우팅 기능을 맡고 있는 계층으로, 목적지까지 가장 안전하고 빠르게 보내는 기능 담당(최적의 경로 설정)
- IP 주소가 헤더에 포함 
- IP 주소
    + 통신 기기에 할당된 식별 번호로, 통신기기마다 고유하게 할당되어 있는 것이 아니라 대부분 통신사에 일정 금액을 지불하고 할당받는 것이기 때문에 경우에 따라 변경 가능성 존재 
- 데이터 단위 : Packet
- 장비 : 라우터,  L3 스위치 등
- **IP(Internet Protocol)**
    + 기본 데이터 단위 : 데이터그램(Datagram)
    + 비신뢰성(Unreliable) : 목적지에 성공적으로 도달한다는 것을 보장하지 않는다.
    + 비연결형(Connectionless) : 상태 정보를 유지하지 않고 각각 독립적으로 처리한다. 
    + 데이터를 전송할 목적지 주소를 지정
    + 최적의 경로 설정 
    
**전송 계층(Transport Layer)**
- 종단 간 신뢰성 있고 정확한 데이터 전송을 담당 
- 오류 검출, 복구, 흐름제어, 중복검사 등 수행
- Port 번호 사용 
- 프로토콜 : TCP/UCP
- 데이터 단위 : 세그먼트 (Segment)

**세션 계층(Session Layer)**
- 통신 장치 간 상호 작용 및 동기화
- 데이터 교환과 에러 발생 시 복구 관리 

**표현 계층(Presentation Layer)**
- 데이터를 어떻게 표한할지 정하는 역할 

**응용 계층(Application Layer)**
- 사용자와 가장 밀접한 계층으로 인터페이스 역할 
- 전자 메일, 인터넷 등 

</br>

### 3. 웹 통신의 큰 흐름 
- 브라우저가 Url에 적힌 값을 파싱해서 HTTP Request Message를 만들고 OS에 전송 요청
- 이 때, 도메인으로 요청을 보낼 수 없으므로 DNS Lookup 을 수행 

</br>

### 우리가 Chrome을 실행시켜 주소창에 특정 Url을 입력시키면 ?
**브라우저로 접속**
1. url 에 입력된 값을 브라우저 내부에서 결정된 규칙에 따라 그 의미를 조사한다.
2. 조사된 의미에 따라 HTTP Request 메시지를 만든다.
3. 만들어진 메시지를 웹 서버로 전송한다.

- 이 때 브라우저는 메시지를 네트워크에 송출하는 기능이 없어 메시지 전송을 직접할 수 없으므로 OS가 대신하게 되는데, 도메인명이 아니라 IP 주소로 메시지를 받을 상태를 지정해야되기 때문에 DNS 서버에서 조회해야 한다. 

**프로토콜 스택, LAN 어댑터**
- 프로토콜 스택 
    + 브라우저가 건내준 메시지를 패킷에 저장하고 수신 주소 등의 제어 정보를 덧붙여 오류가 발생할 시 패킷의 수정 및 통신의 기본을 조절하는 역할 

1. 프로토콜 스택(운영체제에 내장된 네트워크 제어용 소프트웨어)이이 브라우저로부터 메시지를 받는다.
2. 브라우저로부터 받은 메시지를 패킷 속에 저장한다.
3. 그리고 수신처 주소 등의 제어정보를 덧붙인다.
4. 그런 다음, 패킷을 LAN 어댑터에 넘긴다.
5. LAN 어댑터는 다음 Hop의 MAC주소를 붙인 프레임을 전기신호로 변환시킨다.
6. 신호를 LAN 케이블에 송출시킨다.

**허브, 스위치, 라우터**
- 허브(Hub)
    + 여러 대의 컴퓨터를 연결해서 네트워크를 만들어주는 장치로서, 데이터 패킷을 받으면 연결된 모든 장치들에게 모두 전송 
    + 단순 분재를 하는 중계 장치 
    + 데이터 전송 대역을 분리해서 사용 
- 스위치(Switch)
    + 연결된 장치들의 IP 주소와 MAC 주소를 모두 테이블 형태로 가지고, 이를 기반으로 원하는 목적지에 데이터 패킷을 전송
- 라우터(Router)
    + LAN을 연결해주는 장치로서, 최종 목적지에 가기 위해 거처야 하는 많은 경로들 중에서 적절한 통신 경로를 결정하기 위해 한 통신망에서 다른 통신망으로 데이터 패킷을 전송
    + 수많은 라우터들을 거치고 최종 목적지로 도착 
    
1. LAN 어댑터가 송신한 프레임은 스위칭 허브를 경유하여 인터넷 접속용 라우터에 도착한다.
2. 라우터는 패킷을 프로바이더(통신사)에게 전달한다.
3. 인터넷으로 들어가게 된다.

**액세스 회선, 프로바이더**
- 엑세스 회선 
    + 가정이나 회사의 LAN을 인터넷과 연결하는 통신 회선 
- POP(Point Of Presence, 통신사용 라우터)
    + 네트워크 상호 간 또는 개별 네트워크에 대한 접속점 또는 접근점 
    
1. 패킷은 인터넷의 입구에 있는 액세스 회선(통신 회선)에 의해 POP까지 운반된다.
2. POP 를 거쳐 인터넷의 핵심부로 들어가게 된다.
3. 수 많은 고속 라우터들 사이로 패킷이 목적지를 향해 흘러가게 된다.

**방화벽, 캐시 서버**
1. 패킷은 인터넷 핵심부를 통과하여 웹 서버측의 LAN 에 도착한다.
2. 기다리고 있던 방화벽이 도착한 패킷을 검사한다.
3. 패킷이 웹 서버까지 가야하는지 가지 않아도 되는지를 판단하는 캐시서버가 존재한다.

- 액세스한 페이지의 데이터가 캐시서버에 있으면 웹 서버에 의뢰하지 않고 바로 그 값을 읽을 수 있으며, 페이지의 데이터 중에 다시 이용할 수 있는 것이 있으면 캐시 서버에 저장된다.

**웹서버**
1. 패킷이 물리적인 웹 서버에 도착하면 웹 서버의 프로토콜 스택은 패킷을 추출하여 메시지를 복원하고 웹 서버 애플리케이션에 넘긴다.
2. 메시지를 받은 웹 서버 애플리케이션은 요청 메시지에 따른 데이터를 응답 메시지에 넣어 클라이언트로 회송한다.
3. 왔던 방식대로 응답 메시지가 클라이언트에게 전달된다.


